# Traffic Analysis - Nmap Scan Capture

## How the .pcap was generated
Captured during the full execution of the automated vulnerability scan script (`auto-vuln-scan.sh`), which includes Nmap host discovery (-sn), detailed version detection (-sV), default scripts (-sC), and vuln scripts (--script vuln).

Command used on Kali VM:

- Ran in a separate terminal.
- Stopped with Ctrl+C after the script finished (Nmap took ~178–180 seconds).
- Result: 19,757 packets captured (mostly TCP probes to the Domain Controller at 192.168.0.25).

File: `captures/port-scan-example.pcap`  
Size: (you can check with `ls -lh` — typically 5–15 MB for a full Nmap -sV/-sC scan).

## Useful Wireshark filters
Open the .pcap in Wireshark and apply these display filters (paste into the filter bar):

1. `tcp.flags.syn == 1 && tcp.flags.ack == 0`  
   → Shows SYN packets sent by Kali (Nmap probing for open ports). High volume = aggressive port scanning.

2. `tcp.flags.reset == 1` or `tcp.flags.reset == 1 && tcp.flags.ack == 1`  
   → Shows RST or RST-ACK responses from the target. Common for closed/filtered ports (e.g., your packets to 3269 and 636).

3. `tcp.flags.syn == 1 && tcp.flags.ack == 1`  
   → Shows SYN-ACK responses from the target → indicates open ports (successful handshake start).

4. `tcp.port == 5985 or tcp.port == 3269 or tcp.port == 636`  
   → Focus on interesting AD/DC ports (WinRM, Global Catalog LDAP, LDAPS) probed during the scan.

## Key observations from the capture
- **Many RST-ACK responses from the target** (e.g., packets 19728, 19732, 19740 to ports 3269 and 636):  
  This is typical for closed or filtered ports during Nmap's version detection/scripts phase. The target (Windows DC) quickly rejects connections to non-listening ports, generating noise but confirming the port is not open.

- **Successful TCP 3-way handshake on open ports** (e.g., packet 19650 SYN → 19652 SYN-ACK):  
  Seen on ports like 3269 (Global Catalog LDAP). Notice the large TCP window size (Win=65535) and options (MSS=1460, WS=256, SACK_PERM) in the SYN-ACK — typical of modern Windows TCP stack. This confirms the port is truly open and ready for further interaction (though no exploit was attempted).

These patterns highlight "noise vs signal": thousands of probes (noise), but only a few real open services (signal) like LDAP/Kerberos/WinRM.

**Reminder**: This capture only contains reconnaissance traffic — no credentials, exploits, or sensitive data were sent.
